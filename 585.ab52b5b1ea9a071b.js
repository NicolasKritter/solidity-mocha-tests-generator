"use strict";(self.webpackChunksolidity_mocha_tests_generator=self.webpackChunksolidity_mocha_tests_generator||[]).push([[585],{10585:(B,m,i)=>{i.r(m),i.d(m,{UnitTestAppModule:()=>O});var f=i(69808),g=i(93075),v=i(47423),T=i(67322),y=i(78099),h=i(77531),p=i(53251),d=i(34594),$=i(87280),E=i(38766),l=i(97810),A=i(7391),e=i(5e3);let w=(()=>{class s{constructor(){}static initFile(t){return`\n    const ${t} = artifacts.require("${t}");\n    const assert = require("chai").assert;\n    const truffleAssert = require('truffle-assertions');\n\n    `}static addContract(t){return`\n    contract("${t}", (accounts) => {\n\n      let access;\n      const ownerAccount = accounts[0];\n\n      before(async () => {\n          access = await Access.new({\n              from: ownerAccount\n          });\n      });\n    `}static closeFile(){return"});"}static writeOutputs(t){if(t.length<1)return"//TODO Attach Event or getter";let o,n="",r=0;return t.forEach(c=>{o=l.P.parseOut(c),n+=`assert.equal(result['${r}']${o.transfo}, ${o.val}, "should be ${o.val} and type ${o.realType}");\n       `,r++}),n}static writeInputs(t){let r,n="",o="";return t.forEach(c=>{r=l.P.parseIn(c),o+=`const ${r.transfo} = ${r.val}; // ${r.realType}\n`,n+=` ${r.transfo},`}),n.length&&(n=n.slice(0,n.length-1)),{ins:n,vars:o}}static writeFunctionsTest(t){let n=" ";return t.forEach(o=>{n+=s.writeTestForFunction(o)}),n}static writeTestForFunction(t){const n=s.writeInputs(t.inputs),o=s.writeOutputs(t.outputs);return`\n    it('${t.name}', async ()=>{ //TODO TOCHECK\n    ${n.vars}\n     const result = await access.${t.name}(${n.ins});\n     ${o}\n    });\n    `}static writeOutputsEvent(t){let r,n="",o="";return t.forEach(c=>{r=l.P.parseIn(c),n+=` ev.${c.name} == ${r.val} &`,o+=` ${r.transfo}: ${r.realType},`}),n.length&&(n=n.slice(0,n.length-1),n="return "+n+";"),o.length&&(o=o.slice(0,o.length-1)),[n,o]}static writeEvent(t){const n=s.writeOutputsEvent(t.inputs);return`\n            truffleAssert.eventEmitted(callThatTriggersTheEvent, '${t.name}', (ev) => {\n              ${n[0]} // {${n[1]}}\n              });\n          `}static writeEventsTest(t){let n="";return t.forEach(o=>{n+=this.writeEvent(o)}),n}static writeTest(t){const n=(0,A.x)(t),o=l.P.parseABIForElements(n.abi),r=l.P.getContractName(n);console.log("sorted",o);const c=s.writeEventsTest(o.eList);let u=this.initFile(r);return u+=this.addContract(r),u+=this.writeFunctionsTest(o.fList),u+=this.closeFile(),[u,c]}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var b=i(6068);function F(s,a){if(1&s){const t=e.EpF();e.TgZ(0,"div")(1,"mat-tab",3)(2,"div",4)(3,"div",5)(4,"mat-form-field",6)(5,"textarea",7),e._uU(6),e.qZA()(),e.TgZ(7,"button",8),e.NdJ("click",function(){return e.CHM(t),e.oxw().copyResultToClipBoard()}),e._uU(8,"Copy to ClipBoard"),e.qZA()()()(),e.TgZ(9,"mat-tab",9)(10,"div",4)(11,"div",10)(12,"mat-form-field",6)(13,"textarea",11),e._uU(14),e.qZA()(),e.TgZ(15,"button",8),e.NdJ("click",function(){return e.CHM(t),e.oxw().copyEventToClipBoard()}),e._uU(16,"Copy to ClipBoard"),e.qZA()()()()()}if(2&s){const t=e.oxw();e.xp6(6),e.Oqu(t.result),e.xp6(8),e.Oqu(t.events)}}let U=(()=>{class s extends E.S{constructor(){super()}ngOnInit(){}writeTest(t){if(this.abiInput=t,!this.abiInput)return;const n=JSON.parse(this.abiInput),o=w.writeTest(n);this.result=o[0],this.events=o[1]}copyResultToClipBoard(){this.copyToClipboard(this.result)}copyEventToClipBoard(){this.copyToClipboard(this.events)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-unit-test"]],features:[e.qOj],decls:8,vars:1,consts:[["label","ABI"],[3,"onContractLoaded"],[4,"ngIf"],["label","Result - Functions"],[1,"flex-line","margin-h-15","fill-remaining-space"],[1,"element"],[1,"element","width-100"],["rows","25","matInput","","placeholder","Mocha test file",1,"keep-lines","code-font"],["mat-flat-button","","color","primary",3,"click"],["label","Result - Events"],[1,"keep-lines","element"],["rows","25","matInput","","placeholder","Events test code",1,"keep-lines","code-font"]],template:function(t,n){1&t&&(e.TgZ(0,"mat-toolbar")(1,"mat-toolbar-row")(2,"h2"),e._uU(3,"Load ABI & Generate Test File"),e.qZA()()(),e.TgZ(4,"mat-tab-group")(5,"mat-tab",0)(6,"app-abi-importer",1),e.NdJ("onContractLoaded",function(r){return n.writeTest(r)}),e.qZA()(),e.YNc(7,F,17,2,"div",2),e.qZA()),2&t&&(e.xp6(7),e.Q6J("ngIf",n.result))},directives:[d.Ye,d.rD,p.SP,p.uX,b.b,f.O5,T.KE,h.Nt,v.lW],styles:[""]}),s})();var C=i(55020);const x=[{path:"",component:U}];let I=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[C.Bz.forChild(x)],C.Bz]}),s})(),O=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[f.ez,I,p.Nh,T.lN,h.c,y.Ps,d.g0,v.ot,g.u5,$.S]]}),s})()}}]);