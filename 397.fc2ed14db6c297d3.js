"use strict";(self.webpackChunksolidity_mocha_tests_generator=self.webpackChunksolidity_mocha_tests_generator||[]).push([[397],{19397:(E,m,a)=>{a.r(m),a.d(m,{UnitTestAppModule:()=>w});var f=a(86019),c=a(49133),Z=a(17723),h=a(69799),u=a(9804),t=a(83668);let A=(()=>{class o{constructor(){}static initFile(n){return`\n    const ${n} = artifacts.require("${n}");\n    const assert = require("chai").assert;\n    const truffleAssert = require('truffle-assertions');\n\n    `}static addContract(n){return`\n    contract("${n}", (accounts) => {\n\n      let access;\n      const ownerAccount = accounts[0];\n\n      before(async () => {\n          access = await Access.new({\n              from: ownerAccount\n          });\n      });\n    `}static closeFile(){return"});"}static writeOutputs(n){if(n.length<1)return"//TODO Attach Event or getter";let s,e="",r=0;return n.forEach(l=>{s=u.P.parseOut(l),e+=`assert.equal(result['${r}']${s.transfo}, ${s.val}, "should be ${s.val} and type ${s.realType}");\n       `,r++}),e}static writeInputs(n){let r,e="",s="";return n.forEach(l=>{r=u.P.parseIn(l),s+=`const ${r.transfo} = ${r.val}; // ${r.realType}\n`,e+=` ${r.transfo},`}),e.length&&(e=e.slice(0,e.length-1)),{ins:e,vars:s}}static writeFunctionsTest(n){let e=" ";return n.forEach(s=>{e+=o.writeTestForFunction(s)}),e}static writeTestForFunction(n){const e=o.writeInputs(n.inputs),s=o.writeOutputs(n.outputs);return`\n    it('${n.name}', async ()=>{ //TODO TOCHECK\n    ${e.vars}\n     const result = await access.${n.name}(${e.ins});\n     ${s}\n    });\n    `}static writeOutputsEvent(n){let r,e="",s="";return n.forEach(l=>{r=u.P.parseIn(l),e+=` ev.${l.name} == ${r.val} &`,s+=` ${r.transfo}: ${r.realType},`}),e.length&&(e=e.slice(0,e.length-1),e="return "+e+";"),s.length&&(s=s.slice(0,s.length-1)),[e,s]}static writeEvent(n){const e=o.writeOutputsEvent(n.inputs);return`\n            truffleAssert.eventEmitted(callThatTriggersTheEvent, '${n.name}', (ev) => {\n              ${e[0]} // {${e[1]}}\n              });\n          `}static writeEventsTest(n){let e="";return n.forEach(s=>{e+=this.writeEvent(s)}),e}static writeTest(n){const e=u.P.parseABIForElements(n.abi),s=u.P.getContractName(n);console.log("sorted",e);const r=o.writeEventsTest(e.eList);let l=this.initFile(s);return l+=this.addContract(s),l+=this.writeFunctionsTest(e.fList),l+=this.closeFile(),[l,r]}}return o.\u0275fac=function(n){return new(n||o)},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var d=a(58643),g=a(12605),p=a(28167),C=a(10138),b=a(90086),v=a(64141);function U(o,i){if(1&o){const n=t.EpF();t.TgZ(0,"button",17),t.NdJ("click",function(){return t.CHM(n),t.oxw().urlContractJson=""}),t.TgZ(1,"mat-icon"),t._uU(2,"close"),t.qZA(),t.qZA()}}function q(o,i){if(1&o){const n=t.EpF();t.TgZ(0,"mat-tab",18),t.TgZ(1,"div",19),t.TgZ(2,"div",3),t.TgZ(3,"mat-form-field",20),t.TgZ(4,"textarea",21),t._uU(5),t.qZA(),t.qZA(),t.TgZ(6,"button",22),t.NdJ("click",function(){return t.CHM(n),t.oxw().copyResultToClipBoard()}),t._uU(7,"Copy to ClipBoard"),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){const n=t.oxw();t.xp6(5),t.Oqu(n.result)}}function y(o,i){if(1&o){const n=t.EpF();t.TgZ(0,"mat-tab",23),t.TgZ(1,"div",19),t.TgZ(2,"div",24),t.TgZ(3,"mat-form-field",20),t.TgZ(4,"textarea",25),t._uU(5),t.qZA(),t.qZA(),t.TgZ(6,"button",22),t.NdJ("click",function(){return t.CHM(n),t.oxw().copyEventToClipBoard()}),t._uU(7,"Copy to ClipBoard"),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){const n=t.oxw();t.xp6(5),t.Oqu(n.events)}}let _=(()=>{class o extends h.S{constructor(){super()}ngOnInit(){}writeTest(){if(!this.abiInput)return;const n=JSON.parse(this.abiInput),e=A.writeTest(n);this.result=e[0],this.events=e[1]}copyResultToClipBoard(){this.copyToClipboard(this.result)}copyEventToClipBoard(){this.copyToClipboard(this.events)}}return o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-unit-test"]],features:[t.qOj],decls:39,vars:6,consts:[["label","ABI"],["cdkscrollable","",1,"margin-h-15","fill-remaining-space","flex-block"],[1,"element","flex-block","flex-block_column","margin-h-15"],[1,"element"],["type","file",2,"display","none",3,"change"],["fileInput",""],["readonly","","matInput","","type","text",3,"ngModel","ngModelChange"],["mat-flat-button","","color","accent",1,"margin-h-15",3,"click"],["disabled","","matInput","","type","text","placeholder","https://url/contract.json",1,"inpt-text",3,"ngModel","ngModelChange"],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click",4,"ngIf"],[1,"fill-remaining-space"],["disabled","","mat-flat-button","","color","primary"],[1,"element-x-2","flex-block","flex-block_column"],["rows","15","matInput","","placeholder","contract.json generated by truffle or your solc compilation","required","",3,"ngModel","ngModelChange"],["mat-flat-button","","color","accent",3,"click"],["label","Result - Functions",4,"ngIf"],["label","Result - Events",4,"ngIf"],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],["label","Result - Functions"],[1,"flex-line","margin-h-15","fill-remaining-space"],[1,"element","width-100"],["rows","25","matInput","","placeholder","Mocha test file",1,"keep-lines","code-font"],["mat-flat-button","","color","primary",3,"click"],["label","Result - Events"],[1,"keep-lines","element"],["rows","25","matInput","","placeholder","Events test code",1,"keep-lines","code-font"]],template:function(n,e){1&n&&(t.TgZ(0,"mat-toolbar"),t.TgZ(1,"mat-toolbar-row"),t.TgZ(2,"h2"),t._uU(3,"Load ABI & Generate Test File"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(4,"mat-tab-group"),t.TgZ(5,"mat-tab",0),t.TgZ(6,"div",1),t.TgZ(7,"div",2),t.TgZ(8,"h4"),t._uU(9,"Import contract.json from computer"),t.qZA(),t.TgZ(10,"div",3),t.TgZ(11,"div",3),t.TgZ(12,"input",4,5),t.NdJ("change",function(r){return e.onFileChanged(r)}),t.qZA(),t.TgZ(14,"mat-form-field",3),t.TgZ(15,"input",6),t.NdJ("ngModelChange",function(r){return e.fileName=r}),t.qZA(),t.qZA(),t.TgZ(16,"button",7),t.NdJ("click",function(){return e.selectFile()}),t._uU(17,"Select File"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(18,"div",3),t.TgZ(19,"h4"),t._uU(20,"Import contract.json from URL"),t.qZA(),t.TgZ(21,"mat-form-field",3),t.TgZ(22,"mat-label"),t._uU(23,"Load from Url"),t.qZA(),t.TgZ(24,"input",8),t.NdJ("ngModelChange",function(r){return e.urlContractJson=r}),t.qZA(),t.YNc(25,U,3,0,"button",9),t.qZA(),t._UZ(26,"span",10),t.TgZ(27,"button",11),t._uU(28,"Load from url"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(29,"div",12),t.TgZ(30,"h4"),t._uU(31,"Contract.json content"),t.qZA(),t.TgZ(32,"mat-form-field"),t.TgZ(33,"textarea",13),t.NdJ("ngModelChange",function(r){return e.abiInput=r}),t.qZA(),t.qZA(),t.TgZ(34,"div",3),t.TgZ(35,"button",14),t.NdJ("click",function(){return e.writeTest()}),t._uU(36,"Generate Test"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(37,q,8,1,"mat-tab",15),t.YNc(38,y,8,1,"mat-tab",16),t.qZA()),2&n&&(t.xp6(15),t.Q6J("ngModel",e.fileName),t.xp6(9),t.Q6J("ngModel",e.urlContractJson),t.xp6(1),t.Q6J("ngIf",e.urlContractJson),t.xp6(8),t.Q6J("ngModel",e.abiInput),t.xp6(4),t.Q6J("ngIf",e.result),t.xp6(1),t.Q6J("ngIf",e.result))},directives:[d.Ye,d.rD,g.SP,g.uX,p.KE,C.Nt,c.Fj,c.JJ,c.On,b.lW,p.hX,f.O5,c.Q7,p.R9,v.Hw],styles:[""]}),o})();var T=a(33174);const x=[{path:"",component:_}];let I=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[T.Bz.forChild(x)],T.Bz]}),o})(),w=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[f.ez,I,Z.q,c.u5]]}),o})()}}]);