"use strict";(self.webpackChunksolidity_mocha_tests_generator=self.webpackChunksolidity_mocha_tests_generator||[]).push([[585],{10585:(I,m,a)=>{a.r(m),a.d(m,{UnitTestAppModule:()=>x});var f=a(69808),g=a(93075),T=a(47423),d=a(67322),Z=a(68326),h=a(77531),u=a(53251),p=a(34594),A=a(87280),C=a(38766),c=a(97810),t=a(5e3);let b=(()=>{class s{constructor(){}static initFile(e){return`\n    const ${e} = artifacts.require("${e}");\n    const assert = require("chai").assert;\n    const truffleAssert = require('truffle-assertions');\n\n    `}static addContract(e){return`\n    contract("${e}", (accounts) => {\n\n      let access;\n      const ownerAccount = accounts[0];\n\n      before(async () => {\n          access = await Access.new({\n              from: ownerAccount\n          });\n      });\n    `}static closeFile(){return"});"}static writeOutputs(e){if(e.length<1)return"//TODO Attach Event or getter";let o,n="",r=0;return e.forEach(i=>{o=c.P.parseOut(i),n+=`assert.equal(result['${r}']${o.transfo}, ${o.val}, "should be ${o.val} and type ${o.realType}");\n       `,r++}),n}static writeInputs(e){let r,n="",o="";return e.forEach(i=>{r=c.P.parseIn(i),o+=`const ${r.transfo} = ${r.val}; // ${r.realType}\n`,n+=` ${r.transfo},`}),n.length&&(n=n.slice(0,n.length-1)),{ins:n,vars:o}}static writeFunctionsTest(e){let n=" ";return e.forEach(o=>{n+=s.writeTestForFunction(o)}),n}static writeTestForFunction(e){const n=s.writeInputs(e.inputs),o=s.writeOutputs(e.outputs);return`\n    it('${e.name}', async ()=>{ //TODO TOCHECK\n    ${n.vars}\n     const result = await access.${e.name}(${n.ins});\n     ${o}\n    });\n    `}static writeOutputsEvent(e){let r,n="",o="";return e.forEach(i=>{r=c.P.parseIn(i),n+=` ev.${i.name} == ${r.val} &`,o+=` ${r.transfo}: ${r.realType},`}),n.length&&(n=n.slice(0,n.length-1),n="return "+n+";"),o.length&&(o=o.slice(0,o.length-1)),[n,o]}static writeEvent(e){const n=s.writeOutputsEvent(e.inputs);return`\n            truffleAssert.eventEmitted(callThatTriggersTheEvent, '${e.name}', (ev) => {\n              ${n[0]} // {${n[1]}}\n              });\n          `}static writeEventsTest(e){let n="";return e.forEach(o=>{n+=this.writeEvent(o)}),n}static writeTest(e){const n=c.P.parseABIForElements(e.abi),o=c.P.getContractName(e);console.log("sorted",n);const r=s.writeEventsTest(n.eList);let i=this.initFile(o);return i+=this.addContract(o),i+=this.writeFunctionsTest(n.fList),i+=this.closeFile(),[i,r]}}return s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var y=a(6068);function E(s,l){if(1&s){const e=t.EpF();t.TgZ(0,"mat-tab",4),t.TgZ(1,"div",5),t.TgZ(2,"div",6),t.TgZ(3,"mat-form-field",7),t.TgZ(4,"textarea",8),t._uU(5),t.qZA(),t.qZA(),t.TgZ(6,"button",9),t.NdJ("click",function(){return t.CHM(e),t.oxw().copyResultToClipBoard()}),t._uU(7,"Copy to ClipBoard"),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&s){const e=t.oxw();t.xp6(5),t.Oqu(e.result)}}function $(s,l){if(1&s){const e=t.EpF();t.TgZ(0,"mat-tab",10),t.TgZ(1,"div",5),t.TgZ(2,"div",11),t.TgZ(3,"mat-form-field",7),t.TgZ(4,"textarea",12),t._uU(5),t.qZA(),t.qZA(),t.TgZ(6,"button",9),t.NdJ("click",function(){return t.CHM(e),t.oxw().copyEventToClipBoard()}),t._uU(7,"Copy to ClipBoard"),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&s){const e=t.oxw();t.xp6(5),t.Oqu(e.events)}}let w=(()=>{class s extends C.S{constructor(){super()}ngOnInit(){}writeTest(e){if(this.abiInput=e,!this.abiInput)return;const n=JSON.parse(this.abiInput),o=b.writeTest(n);this.result=o[0],this.events=o[1]}copyResultToClipBoard(){this.copyToClipboard(this.result)}copyEventToClipBoard(){this.copyToClipboard(this.events)}}return s.\u0275fac=function(e){return new(e||s)},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-unit-test"]],features:[t.qOj],decls:9,vars:2,consts:[["label","ABI"],[3,"onContractLoaded"],["label","Result - Functions",4,"ngIf"],["label","Result - Events",4,"ngIf"],["label","Result - Functions"],[1,"flex-line","margin-h-15","fill-remaining-space"],[1,"element"],[1,"element","width-100"],["rows","25","matInput","","placeholder","Mocha test file",1,"keep-lines","code-font"],["mat-flat-button","","color","primary",3,"click"],["label","Result - Events"],[1,"keep-lines","element"],["rows","25","matInput","","placeholder","Events test code",1,"keep-lines","code-font"]],template:function(e,n){1&e&&(t.TgZ(0,"mat-toolbar"),t.TgZ(1,"mat-toolbar-row"),t.TgZ(2,"h2"),t._uU(3,"Load ABI & Generate Test File"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(4,"mat-tab-group"),t.TgZ(5,"mat-tab",0),t.TgZ(6,"app-abi-importer",1),t.NdJ("onContractLoaded",function(r){return n.writeTest(r)}),t.qZA(),t.qZA(),t.YNc(7,E,8,1,"mat-tab",2),t.YNc(8,$,8,1,"mat-tab",3),t.qZA()),2&e&&(t.xp6(7),t.Q6J("ngIf",n.result),t.xp6(1),t.Q6J("ngIf",n.result))},directives:[p.Ye,p.rD,u.SP,u.uX,y.b,f.O5,d.KE,h.Nt,T.lW],styles:[""]}),s})();var v=a(55020);const F=[{path:"",component:w}];let U=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[[v.Bz.forChild(F)],v.Bz]}),s})(),x=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[[f.ez,U,u.Nh,d.lN,h.c,Z.Ps,p.g0,T.ot,g.u5,A.S]]}),s})()}}]);