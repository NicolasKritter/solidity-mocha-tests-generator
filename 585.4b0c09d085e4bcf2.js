"use strict";(self.webpackChunksolidity_mocha_tests_generator=self.webpackChunksolidity_mocha_tests_generator||[]).push([[585],{10585:(O,m,a)=>{a.r(m),a.d(m,{UnitTestAppModule:()=>I});var f=a(69808),C=a(93075),d=a(47423),T=a(67322),g=a(78099),h=a(77531),u=a(53251),p=a(34594),b=a(87280),y=a(38766),c=a(97810),e=a(5e3);let E=(()=>{class s{constructor(){}static initFile(t){return`\n    const ${t} = artifacts.require("${t}");\n    const assert = require("chai").assert;\n    const truffleAssert = require('truffle-assertions');\n\n    `}static addContract(t){return`\n    contract("${t}", (accounts) => {\n\n      let access;\n      const ownerAccount = accounts[0];\n\n      before(async () => {\n          access = await Access.new({\n              from: ownerAccount\n          });\n      });\n    `}static closeFile(){return"});"}static writeOutputs(t){if(t.length<1)return"//TODO Attach Event or getter";let o,n="",r=0;return t.forEach(i=>{o=c.P.parseOut(i),n+=`assert.equal(result['${r}']${o.transfo}, ${o.val}, "should be ${o.val} and type ${o.realType}");\n       `,r++}),n}static writeInputs(t){let r,n="",o="";return t.forEach(i=>{r=c.P.parseIn(i),o+=`const ${r.transfo} = ${r.val}; // ${r.realType}\n`,n+=` ${r.transfo},`}),n.length&&(n=n.slice(0,n.length-1)),{ins:n,vars:o}}static writeFunctionsTest(t){let n=" ";return t.forEach(o=>{n+=s.writeTestForFunction(o)}),n}static writeTestForFunction(t){const n=s.writeInputs(t.inputs),o=s.writeOutputs(t.outputs);return`\n    it('${t.name}', async ()=>{ //TODO TOCHECK\n    ${n.vars}\n     const result = await access.${t.name}(${n.ins});\n     ${o}\n    });\n    `}static writeOutputsEvent(t){let r,n="",o="";return t.forEach(i=>{r=c.P.parseIn(i),n+=` ev.${i.name} == ${r.val} &`,o+=` ${r.transfo}: ${r.realType},`}),n.length&&(n=n.slice(0,n.length-1),n="return "+n+";"),o.length&&(o=o.slice(0,o.length-1)),[n,o]}static writeEvent(t){const n=s.writeOutputsEvent(t.inputs);return`\n            truffleAssert.eventEmitted(callThatTriggersTheEvent, '${t.name}', (ev) => {\n              ${n[0]} // {${n[1]}}\n              });\n          `}static writeEventsTest(t){let n="";return t.forEach(o=>{n+=this.writeEvent(o)}),n}static writeTest(t){const n=c.P.parseABIForElements(t.abi),o=c.P.getContractName(t);console.log("sorted",n);const r=s.writeEventsTest(n.eList);let i=this.initFile(o);return i+=this.addContract(o),i+=this.writeFunctionsTest(n.fList),i+=this.closeFile(),[i,r]}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var $=a(6068);function w(s,l){if(1&s){const t=e.EpF();e.TgZ(0,"mat-tab",4)(1,"div",5)(2,"div",6)(3,"mat-form-field",7)(4,"textarea",8),e._uU(5),e.qZA()(),e.TgZ(6,"button",9),e.NdJ("click",function(){return e.CHM(t),e.oxw().copyResultToClipBoard()}),e._uU(7,"Copy to ClipBoard"),e.qZA()()()()}if(2&s){const t=e.oxw();e.xp6(5),e.Oqu(t.result)}}function A(s,l){if(1&s){const t=e.EpF();e.TgZ(0,"mat-tab",10)(1,"div",5)(2,"div",11)(3,"mat-form-field",7)(4,"textarea",12),e._uU(5),e.qZA()(),e.TgZ(6,"button",9),e.NdJ("click",function(){return e.CHM(t),e.oxw().copyEventToClipBoard()}),e._uU(7,"Copy to ClipBoard"),e.qZA()()()()}if(2&s){const t=e.oxw();e.xp6(5),e.Oqu(t.events)}}let F=(()=>{class s extends y.S{constructor(){super()}ngOnInit(){}writeTest(t){if(this.abiInput=t,!this.abiInput)return;const n=JSON.parse(this.abiInput),o=E.writeTest(n);this.result=o[0],this.events=o[1]}copyResultToClipBoard(){this.copyToClipboard(this.result)}copyEventToClipBoard(){this.copyToClipboard(this.events)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-unit-test"]],features:[e.qOj],decls:9,vars:2,consts:[["label","ABI"],[3,"onContractLoaded"],["label","Result - Functions",4,"ngIf"],["label","Result - Events",4,"ngIf"],["label","Result - Functions"],[1,"flex-line","margin-h-15","fill-remaining-space"],[1,"element"],[1,"element","width-100"],["rows","25","matInput","","placeholder","Mocha test file",1,"keep-lines","code-font"],["mat-flat-button","","color","primary",3,"click"],["label","Result - Events"],[1,"keep-lines","element"],["rows","25","matInput","","placeholder","Events test code",1,"keep-lines","code-font"]],template:function(t,n){1&t&&(e.TgZ(0,"mat-toolbar")(1,"mat-toolbar-row")(2,"h2"),e._uU(3,"Load ABI & Generate Test File"),e.qZA()()(),e.TgZ(4,"mat-tab-group")(5,"mat-tab",0)(6,"app-abi-importer",1),e.NdJ("onContractLoaded",function(r){return n.writeTest(r)}),e.qZA()(),e.YNc(7,w,8,1,"mat-tab",2),e.YNc(8,A,8,1,"mat-tab",3),e.qZA()),2&t&&(e.xp6(7),e.Q6J("ngIf",n.result),e.xp6(1),e.Q6J("ngIf",n.result))},directives:[p.Ye,p.rD,u.SP,u.uX,$.b,f.O5,T.KE,h.Nt,d.lW],styles:[""]}),s})();var v=a(55020);const U=[{path:"",component:F}];let x=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[v.Bz.forChild(U)],v.Bz]}),s})(),I=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[f.ez,x,u.Nh,T.lN,h.c,g.Ps,p.g0,d.ot,C.u5,b.S]]}),s})()}}]);